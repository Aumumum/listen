{"version":3,"file":"adapter.js","sourceRoot":"","sources":["../../../src/classes/adapter.ts"],"names":[],"mappings":"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","sourcesContent":["import { Logger } from './logger';\r\nimport { Buffer } from './buffer';\r\nimport { Reactive } from './reactive';\r\nimport {\r\n  AdapterPropName, AdapterPropType, getDefaultAdapterProps, methodPreResult, reactiveConfigStorage\r\n} from './adapter/props';\r\nimport { AdapterProcess, ProcessStatus } from '../processes/index';\r\nimport {\r\n  WorkflowGetter,\r\n  IAdapterProp,\r\n  AdapterMethodResult,\r\n  IAdapter,\r\n  ItemAdapter,\r\n  ItemsPredicate,\r\n  AdapterPrependOptions,\r\n  AdapterAppendOptions,\r\n  AdapterRemoveOptions,\r\n  AdapterClipOptions,\r\n  AdapterInsertOptions,\r\n  AdapterReplaceOptions,\r\n  AdapterUpdateOptions,\r\n  AdapterFixOptions,\r\n  ScrollerWorkflow,\r\n  IDatasourceOptional,\r\n  IPackages,\r\n  IBufferInfo,\r\n  State,\r\n  ProcessSubject,\r\n} from '../interfaces/index';\r\n\r\ntype MethodResolver = (...args: any[]) => Promise<AdapterMethodResult>;\r\n\r\nconst ADAPTER_PROPS_STUB = getDefaultAdapterProps();\r\n\r\nconst _has = (obj: unknown, prop: string): boolean =>\r\n  typeof obj === 'object' && obj !== null && Object.prototype.hasOwnProperty.call(obj, prop);\r\n\r\nconst convertAppendArgs = <Item>(prepend: boolean, options: unknown, eof?: boolean) => {\r\n  let result = options as AdapterAppendOptions<Item> & AdapterPrependOptions<Item>;\r\n  if (!_has(options, 'items')) {\r\n    const items = !Array.isArray(options) ? [options] : options;\r\n    result = prepend ? { items, bof: eof } : { items, eof: eof };\r\n  }\r\n  return result;\r\n};\r\n\r\nconst convertRemoveArgs = <Item>(options: AdapterRemoveOptions<Item> | ItemsPredicate<Item>) => {\r\n  if (!(_has(options, 'predicate') || _has(options, 'indexes'))) {\r\n    const predicate = options as ItemsPredicate<Item>;\r\n    options = { predicate };\r\n  }\r\n  return options;\r\n};\r\n\r\nexport class Adapter<Item = unknown> implements IAdapter<Item> {\r\n  private externalContext: IAdapter<Item>;\r\n  private logger: Logger;\r\n  private getWorkflow: WorkflowGetter<Item>;\r\n  private reloadCounter: number;\r\n  private source: { [key: string]: Reactive<unknown> } = {}; // for Reactive props\r\n  private box: { [key: string]: unknown } = {}; // for Scalars over Reactive props\r\n  private demand: { [key: string]: unknown } = {}; // for Scalars on demand\r\n  public wanted: { [key: string]: boolean } = {};\r\n\r\n  get workflow(): ScrollerWorkflow<Item> {\r\n    return this.getWorkflow();\r\n  }\r\n  get reloadCount(): number {\r\n    return this.reloadCounter;\r\n  }\r\n  get reloadId(): string {\r\n    return this.id + '.' + this.reloadCounter;\r\n  }\r\n\r\n  id: number;\r\n  mock: boolean;\r\n  augmented: boolean;\r\n  version: string;\r\n  init: boolean;\r\n  init$: Reactive<boolean>;\r\n  packageInfo: IPackages;\r\n  itemsCount: number;\r\n  bufferInfo: IBufferInfo;\r\n  isLoading: boolean;\r\n  isLoading$: Reactive<boolean>;\r\n  loopPending: boolean;\r\n  loopPending$: Reactive<boolean>;\r\n  firstVisible: ItemAdapter<Item>;\r\n  firstVisible$: Reactive<ItemAdapter<Item>>;\r\n  lastVisible: ItemAdapter<Item>;\r\n  lastVisible$: Reactive<ItemAdapter<Item>>;\r\n  bof: boolean;\r\n  bof$: Reactive<boolean>;\r\n  eof: boolean;\r\n  eof$: Reactive<boolean>;\r\n\r\n  private relax$: Reactive<AdapterMethodResult> | null;\r\n  private relaxRun: Promise<AdapterMethodResult> | null;\r\n\r\n  private getPromisifiedMethod(method: MethodResolver, defaultMethod: MethodResolver) {\r\n    return (...args: any[]): Promise<AdapterMethodResult> =>\r\n      this.relax$\r\n        ? new Promise(resolve => {\r\n          if (this.relax$) {\r\n            this.relax$.once(value => resolve(value));\r\n          }\r\n          method.apply(this, args);\r\n        })\r\n        : defaultMethod.apply(this, args);\r\n  }\r\n\r\n  constructor(context: IAdapter<Item> | null, getWorkflow: WorkflowGetter<Item>, logger: Logger) {\r\n    this.getWorkflow = getWorkflow;\r\n    this.logger = logger;\r\n    this.relax$ = null;\r\n    this.relaxRun = null;\r\n    this.reloadCounter = 0;\r\n\r\n    // public context (if exists) should provide access Reactive props configuration by id\r\n    const reactivePropsStore = context && reactiveConfigStorage.get(context.id) || {};\r\n\r\n    // make array of the original values from public context if present\r\n    const adapterProps = context\r\n      ? ADAPTER_PROPS_STUB.map(prop => {\r\n        let value = context[prop.name];\r\n        // if context is augmented, we need to replace external reactive props with inner ones\r\n        if (context.augmented) {\r\n          const reactiveProp = reactivePropsStore[prop.name];\r\n          if (reactiveProp) {\r\n            value = reactiveProp.default as Reactive<boolean>; // boolean doesn't matter here\r\n          }\r\n        }\r\n        return ({ ...prop, value });\r\n      })\r\n      : getDefaultAdapterProps();\r\n\r\n    // restore default reactive props if they were configured\r\n    Object.entries(reactivePropsStore).forEach(([key, value]) => {\r\n      const prop = adapterProps.find(({ name }) => name === key);\r\n      if (prop && value) {\r\n        prop.value = value.default;\r\n      }\r\n    });\r\n\r\n    // Scalar permanent props\r\n    adapterProps\r\n      .filter(({ type, permanent }) => type === AdapterPropType.Scalar && permanent)\r\n      .forEach(({ name, value }: IAdapterProp) =>\r\n        Object.defineProperty(this, name, {\r\n          configurable: true,\r\n          get: () => value\r\n        })\r\n      );\r\n\r\n    // Reactive props\r\n    // 1) store original values in \"source\" container, to avoid extra .get() calls on scalar twins set\r\n    // 2) \"wanted\" container is bound with scalars; get() updates it\r\n    adapterProps\r\n      .filter(prop => prop.type === AdapterPropType.Reactive)\r\n      .forEach(({ name, value }: IAdapterProp) => {\r\n        this.source[name] = value as Reactive<unknown>;\r\n        Object.defineProperty(this, name, {\r\n          configurable: true,\r\n          get: () => {\r\n            const scalarWanted = ADAPTER_PROPS_STUB.find(\r\n              ({ wanted, reactive }) => wanted && reactive === name\r\n            );\r\n            if (scalarWanted) {\r\n              this.wanted[scalarWanted.name] = true;\r\n            }\r\n            return this.source[name];\r\n          }\r\n        });\r\n      });\r\n\r\n    // Scalar props that have Reactive twins\r\n    // 1) scalars should use \"box\" container\r\n    // 2) \"wanted\" should be updated on get\r\n    // 3) reactive props (from \"source\") are triggered on set\r\n    adapterProps\r\n      .filter(prop => prop.type === AdapterPropType.Scalar && !!prop.reactive)\r\n      .forEach(({ name, value, reactive, wanted }: IAdapterProp) => {\r\n        if (wanted) {\r\n          this.wanted[name] = false;\r\n        }\r\n        this.box[name] = value;\r\n        Object.defineProperty(this, name, {\r\n          configurable: true,\r\n          set: (newValue: unknown) => {\r\n            if (newValue !== this.box[name]) {\r\n              this.box[name] = newValue;\r\n              this.source[reactive as AdapterPropName].set(newValue);\r\n              // need to emit new value through the configured reactive prop if present\r\n              const reactiveProp = reactivePropsStore[reactive as AdapterPropName];\r\n              if (reactiveProp) {\r\n                reactiveProp.emit(reactiveProp.source, newValue);\r\n              }\r\n            }\r\n          },\r\n          get: () => {\r\n            if (wanted) {\r\n              this.wanted[name] = true;\r\n            }\r\n            return this.box[name];\r\n          }\r\n        });\r\n      });\r\n\r\n    // Scalar props on-demand\r\n    // these scalars should use \"demand\" container\r\n    // setting defaults should be overridden on init()\r\n    adapterProps\r\n      .filter(prop => prop.type === AdapterPropType.Scalar && prop.onDemand)\r\n      .forEach(({ name, value }: IAdapterProp) => {\r\n        this.demand[name] = value;\r\n        Object.defineProperty(this, name, {\r\n          configurable: true,\r\n          get: () => this.demand[name]\r\n        });\r\n      });\r\n\r\n    if (!context) {\r\n      return;\r\n    }\r\n\r\n    // Adapter public context augmentation\r\n    adapterProps\r\n      .forEach(({ name, type, value: defaultValue, permanent }: IAdapterProp) => {\r\n        let value = (this as IAdapter)[name];\r\n        if (type === AdapterPropType.Function) {\r\n          value = (value as () => void).bind(this);\r\n        } else if (type === AdapterPropType.WorkflowRunner) {\r\n          value = this.getPromisifiedMethod(value as MethodResolver, defaultValue as MethodResolver);\r\n        } else if (type === AdapterPropType.Reactive && reactivePropsStore[name]) {\r\n          value = (context as IAdapter)[name];\r\n        } else if (name === AdapterPropName.augmented) {\r\n          value = true;\r\n        }\r\n        Object.defineProperty(context, name, {\r\n          configurable: true,\r\n          get: () => !permanent && type === AdapterPropType.Scalar\r\n            ? (this as IAdapter)[name] // non-permanent Scalars should be taken in runtime\r\n            : value // Reactive props and methods (Functions/WorkflowRunners) can be defined once\r\n        });\r\n      });\r\n\r\n    this.externalContext = context;\r\n  }\r\n\r\n  initialize(buffer: Buffer<Item>, state: State, logger: Logger, adapterRun$?: Reactive<ProcessSubject>): void {\r\n    // buffer\r\n    Object.defineProperty(this.demand, AdapterPropName.itemsCount, {\r\n      get: () => buffer.getVisibleItemsCount()\r\n    });\r\n    Object.defineProperty(this.demand, AdapterPropName.bufferInfo, {\r\n      get: (): IBufferInfo => ({\r\n        firstIndex: buffer.firstIndex,\r\n        lastIndex: buffer.lastIndex,\r\n        minIndex: buffer.minIndex,\r\n        maxIndex: buffer.maxIndex,\r\n        absMinIndex: buffer.absMinIndex,\r\n        absMaxIndex: buffer.absMaxIndex,\r\n        defaultSize: buffer.defaultSize,\r\n      })\r\n    });\r\n    this.bof = buffer.bof.get();\r\n    buffer.bof.on(bof => this.bof = bof);\r\n    this.eof = buffer.eof.get();\r\n    buffer.eof.on(eof => this.eof = eof);\r\n\r\n    // state\r\n    Object.defineProperty(this.demand, AdapterPropName.packageInfo, {\r\n      get: () => state.packageInfo\r\n    });\r\n    this.loopPending = state.cycle.innerLoop.busy.get();\r\n    state.cycle.innerLoop.busy.on(busy => this.loopPending = busy);\r\n    this.isLoading = state.cycle.busy.get();\r\n    state.cycle.busy.on(busy => this.isLoading = busy);\r\n\r\n    // logger\r\n    this.logger = logger;\r\n\r\n    // self-pending subscription; set up only on the very first init\r\n    if (adapterRun$) {\r\n      if (!this.relax$) {\r\n        this.relax$ = new Reactive();\r\n      }\r\n      const relax$ = this.relax$;\r\n      adapterRun$.on(({ status, payload }) => {\r\n        let unSubRelax = () => { };\r\n        if (status === ProcessStatus.start) {\r\n          unSubRelax = this.isLoading$.on(value => {\r\n            if (!value) {\r\n              unSubRelax();\r\n              relax$.set({ success: true, immediate: false, details: null });\r\n            }\r\n          });\r\n        } else if (status === ProcessStatus.done || status === ProcessStatus.error) {\r\n          unSubRelax();\r\n          relax$.set({\r\n            success: status !== ProcessStatus.error,\r\n            immediate: true,\r\n            details: status === ProcessStatus.error && payload ? String(payload.error) : null\r\n          });\r\n        }\r\n      });\r\n    }\r\n\r\n    // init\r\n    this.init = true;\r\n  }\r\n\r\n  dispose(): void {\r\n    if (this.relax$) {\r\n      this.relax$.dispose();\r\n    }\r\n    if (this.externalContext) {\r\n      this.resetContext();\r\n    }\r\n    Object.getOwnPropertyNames(this).forEach(prop => {\r\n      delete (this as Record<string, unknown>)[prop];\r\n    });\r\n  }\r\n\r\n  resetContext(): void {\r\n    const reactiveStore = reactiveConfigStorage.get(this.externalContext.id);\r\n    ADAPTER_PROPS_STUB\r\n      .forEach(({ type, permanent, name, value }) => {\r\n        // assign initial values to non-reactive non-permanent props\r\n        if (type !== AdapterPropType.Reactive && !permanent) {\r\n          Object.defineProperty(this.externalContext, name, {\r\n            configurable: true,\r\n            get: () => value\r\n          });\r\n        }\r\n        // reset reactive props\r\n        if (type === AdapterPropType.Reactive && reactiveStore) {\r\n          const property = reactiveStore[name];\r\n          if (property) {\r\n            property.default.reset();\r\n            property.emit(property.source, property.default.get());\r\n          }\r\n        }\r\n      });\r\n  }\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  reset(options?: IDatasourceOptional): any {\r\n    this.reloadCounter++;\r\n    this.logger.logAdapterMethod('reset', options, ` of ${this.reloadId}`);\r\n    this.workflow.call({\r\n      process: AdapterProcess.reset,\r\n      status: ProcessStatus.start,\r\n      payload: { options }\r\n    });\r\n  }\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  reload(options?: number | string): any {\r\n    this.reloadCounter++;\r\n    this.logger.logAdapterMethod('reload', options, ` of ${this.reloadId}`);\r\n    this.workflow.call({\r\n      process: AdapterProcess.reload,\r\n      status: ProcessStatus.start,\r\n      payload: { options }\r\n    });\r\n  }\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  append(_options: AdapterAppendOptions<Item> | unknown, eof?: boolean): any {\r\n    const options = convertAppendArgs(false, _options, eof); // support old signature\r\n    this.logger.logAdapterMethod('append', [options.items, options.eof]);\r\n    this.workflow.call({\r\n      process: AdapterProcess.append,\r\n      status: ProcessStatus.start,\r\n      payload: { options }\r\n    });\r\n  }\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  prepend(_options: AdapterPrependOptions<Item> | unknown, bof?: boolean): any {\r\n    const options = convertAppendArgs(true, _options, bof); // support old signature\r\n    this.logger.logAdapterMethod('prepend', [options.items, options.bof]);\r\n    this.workflow.call({\r\n      process: AdapterProcess.prepend,\r\n      status: ProcessStatus.start,\r\n      payload: { options }\r\n    });\r\n  }\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  check(): any {\r\n    this.logger.logAdapterMethod('check');\r\n    this.workflow.call({\r\n      process: AdapterProcess.check,\r\n      status: ProcessStatus.start\r\n    });\r\n  }\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  remove(options: AdapterRemoveOptions<Item> | ItemsPredicate<Item>): any {\r\n    options = convertRemoveArgs(options); // support old signature\r\n    this.logger.logAdapterMethod('remove', options);\r\n    this.workflow.call({\r\n      process: AdapterProcess.remove,\r\n      status: ProcessStatus.start,\r\n      payload: { options }\r\n    });\r\n  }\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  clip(options?: AdapterClipOptions): any {\r\n    this.logger.logAdapterMethod('clip', options);\r\n    this.workflow.call({\r\n      process: AdapterProcess.clip,\r\n      status: ProcessStatus.start,\r\n      payload: { options }\r\n    });\r\n  }\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  insert(options: AdapterInsertOptions<Item>): any {\r\n    this.logger.logAdapterMethod('insert', options);\r\n    this.workflow.call({\r\n      process: AdapterProcess.insert,\r\n      status: ProcessStatus.start,\r\n      payload: { options }\r\n    });\r\n  }\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  replace(options: AdapterReplaceOptions<Item>): any {\r\n    this.logger.logAdapterMethod('replace', options);\r\n    this.workflow.call({\r\n      process: AdapterProcess.replace,\r\n      status: ProcessStatus.start,\r\n      payload: { options }\r\n    });\r\n  }\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  update(options: AdapterUpdateOptions<Item>): any {\r\n    this.logger.logAdapterMethod('update', options);\r\n    this.workflow.call({\r\n      process: AdapterProcess.update,\r\n      status: ProcessStatus.start,\r\n      payload: { options }\r\n    });\r\n  }\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  fix(options: AdapterFixOptions<Item>): any {\r\n    this.logger.logAdapterMethod('fix', options);\r\n    this.workflow.call({\r\n      process: AdapterProcess.fix,\r\n      status: ProcessStatus.start,\r\n      payload: { options }\r\n    });\r\n  }\r\n\r\n  relaxUnchained(callback: (() => void) | undefined, reloadId: string): Promise<AdapterMethodResult> {\r\n    const runCallback = () => typeof callback === 'function' && reloadId === this.reloadId && callback();\r\n    if (!this.isLoading) {\r\n      runCallback();\r\n    }\r\n    return new Promise<boolean>(resolve => {\r\n      if (!this.isLoading) {\r\n        resolve(true);\r\n        return;\r\n      }\r\n      this.isLoading$.once(() => {\r\n        runCallback();\r\n        resolve(false);\r\n      });\r\n    }).then(immediate => {\r\n      const success = reloadId === this.reloadId;\r\n      this.logger.log(() => !success ? `relax promise cancelled due to ${reloadId} != ${this.reloadId}` : void 0);\r\n      return {\r\n        immediate,\r\n        success,\r\n        details: !success ? 'Interrupted by reload or reset' : null\r\n      };\r\n    });\r\n  }\r\n\r\n  relax(callback?: () => void): Promise<AdapterMethodResult> {\r\n    const reloadId = this.reloadId;\r\n    this.logger.logAdapterMethod('relax', callback, ` of ${reloadId}`);\r\n    if (!this.init) {\r\n      return Promise.resolve(methodPreResult);\r\n    }\r\n    return this.relaxRun = this.relaxRun\r\n      ? this.relaxRun.then(() => this.relaxUnchained(callback, reloadId))\r\n      : this.relaxUnchained(callback, reloadId).then((result) => {\r\n        this.relaxRun = null;\r\n        return result;\r\n      });\r\n  }\r\n\r\n  showLog(): void {\r\n    this.logger.logAdapterMethod('showLog');\r\n    this.logger.logForce();\r\n  }\r\n}\r\n"]}